/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var S=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var $=Object.prototype.hasOwnProperty;var I=(h,i)=>{for(var e in i)S(h,e,{get:i[e],enumerable:!0})},L=(h,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of P(i))!$.call(h,a)&&a!==e&&S(h,a,{get:()=>i[a],enumerable:!(t=N(i,a))||t.enumerable});return h};var V=h=>L(S({},"__esModule",{value:!0}),h);var A={};I(A,{default:()=>F});module.exports=V(A);var u=require("obsidian");var M={templateFolder:"Templates",enableFolderTemplates:!0,dateVariables:!0,templateMenuStyle:"grouped",templateConfigs:[],templateDisplayMode:"both"};var p=require("obsidian");function T(h){if(/[<>:"|?*\\/]/.test(h))return{valid:!1,error:'Contains illegal characters: < > : " | ? * \\ /'};if(!h.trim())return{valid:!1,error:"Name cannot be empty"};let e=["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"],t=h.split(".")[0].toUpperCase();return e.includes(t)?{valid:!1,error:`"${t}" is a reserved name`}:{valid:!0}}function E(h){return h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var v=class{constructor(i){this.settings=i}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}processVariables(i,e){if(!this.settings.dateVariables)return i;let t=i;if(t.includes("{{+Number}}")){let d=this.getAutoIncrementNumber(t,e);t=t.replace(/\{\{\+Number\}\}/g,d)}let a=new Date,s=a.toISOString().split("T")[0],o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=o[a.getDay()],r=a.toTimeString().slice(0,5),c=a.getHours().toString().padStart(2,"0"),l=a.getMinutes().toString().padStart(2,"0");console.log("Processing variables for text:",i),t=t.replace(/\{\{date\}\}/g,s).replace(/\{\{dayName\}\}/g,n).replace(/\{\{year\}\}/g,a.getFullYear().toString()).replace(/\{\{month\}\}/g,(a.getMonth()+1).toString().padStart(2,"0")).replace(/\{\{day\}\}/g,a.getDate().toString().padStart(2,"0")).replace(/\{\{time\}\}/g,r).replace(/\{\{hour\}\}/g,c).replace(/\{\{minute\}\}/g,l).replace(/\{\{uuid\}\}/g,()=>this.generateUUID());for(let d=1;d<=7;d++){let g=d===7?0:d;t=t.replace(new RegExp(`\\{\\{weekDay${d}\\}\\}`,"g"),o[g])}return console.log("Final result:",t),t}getAutoIncrementNumber(i,e){let s=`^${i.split(/\{\{\+Number\}\}/g).map(l=>{let d=E(l),g=/\{\{.*?\}\}/g,f;for(;(f=g.exec(l))!==null;){let C=E(f[0]);d=d.replace(C,".*")}return d}).join("(\\d+)")}$`,o=new RegExp(s),r=e.children.map(l=>l.name).map(l=>{let d=l.match(o);return d&&d[1]?parseInt(d[1],10):0}).filter(l=>l>0);return(r.length>0?Math.max(...r)+1:1).toString().padStart(2,"0")}getPreviewName(i,e){try{return this.processVariables(i,e)}catch(t){return`[Error: ${t.message}]`}}};var y=require("obsidian"),x=class extends y.SuggestModal{constructor(e,t,a){super(e);this.templates=t,this.onSelect=a}getSuggestions(e){return this.templates.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))}renderSuggestion(e,t){let a=e instanceof y.TFolder?"Folder":"File";t.createEl("div",{text:e.name}),t.createEl("small",{text:`${a} - ${e.path}`,cls:"template-path"})}onChooseSuggestion(e){this.onSelect(e)}};var b=class{constructor(i,e){this.app=i;this.settings=e;this.cachedTemplates=null;this.processor=new v(e)}async initializeCache(){if(this.settings.templateMenuStyle==="individual")try{this.cachedTemplates=await this.getTemplates(),console.log("Cached templates:",this.cachedTemplates)}catch(i){console.error("Failed to cache templates:",i)}}async updateCache(){if(this.settings.templateMenuStyle==="individual")try{this.cachedTemplates=await this.getTemplates(),console.log("Updated cached templates:",this.cachedTemplates)}catch(i){console.error("Failed to update cached templates:",i)}else this.cachedTemplates=null}addTemplateContextMenu(i,e){if(console.log("Template menu style:",this.settings.templateMenuStyle),this.settings.templateMenuStyle==="grouped")i.addItem(t=>{t.setTitle("Create from template").setIcon("file-plus").onClick(()=>{this.showTemplateSelector(e)})});else{let t=this.cachedTemplates,a=this.filterAndSortTemplates(t||[]);if(console.log("Using cached templates:",a),!a||a.length===0){i.addItem(s=>{s.setTitle("No templates found").setIcon("file-x").setDisabled(!0)});return}for(let s of a){let o=s instanceof p.TFolder?"folder":"file-text",n=this.processor.getPreviewName(s.name,e),r=T(n),c;switch(this.settings.templateDisplayMode){case"template":c=s.name;break;case"result":c=n;break;case"both":default:n===s.name?c=s.name:c=`${s.name} \u2192 ${n}`;break}r.valid||(c+=" (Invalid)"),console.log(`Adding menu item: ${c}, icon: ${o}`),i.addItem(l=>{console.log("Creating menu item for:",s.name),l.setTitle(c).setIcon(o),r.valid?l.onClick(()=>{console.log("Clicked on template:",s.name),s instanceof p.TFile?this.createFileFromTemplate(s,e):s instanceof p.TFolder&&this.createFolderFromTemplate(s,e)}):l.setDisabled(!0)})}}}async showTemplateSelector(i){try{let e=await this.getTemplates();if(e.length===0){new p.Notice("No templates found in the template folder");return}new x(this.app,e,t=>{t instanceof p.TFile?this.createFileFromTemplate(t,i):t instanceof p.TFolder&&this.createFolderFromTemplate(t,i)}).open()}catch(e){console.error("Error loading templates:",e),new p.Notice("Error loading templates. Check console for details.")}}async createFileFromTemplate(i,e){try{let t=await this.app.vault.read(i),a=this.processor.processVariables(t,e),s=this.processor.processVariables(i.name,e);s===i.name&&(s=i.name);let o=T(s);if(!o.valid){new p.Notice(`Cannot create file: ${o.error}`);return}let n=`${e.path}/${s}`,r=await this.app.vault.create(n,a);await this.app.workspace.getLeaf(!1).openFile(r),new p.Notice(`Created: ${s}`)}catch(t){console.error("Error creating file from template:",t),new p.Notice("Error creating file. Check console for details.")}}async createFolderFromTemplate(i,e){try{let t=this.processor.processVariables(i.name,e),a=T(t);if(!a.valid){new p.Notice(`Cannot create folder: ${a.error}`);return}console.log("Creating folder with name:",t);let s=`${e.path}/${t}`,o=await this.app.vault.createFolder(s);await this.copyFolderContents(i,o),new p.Notice(`Created folder: ${t}`)}catch(t){console.error("Error creating folder from template:",t),new p.Notice("Error creating folder. Check console for details.")}}async copyFolderContents(i,e){for(let t of i.children)if(t instanceof p.TFile){let a=await this.app.vault.read(t),s=this.processor.processVariables(a,e),o=this.processor.processVariables(t.name,e),n=T(o);if(!n.valid){console.warn(`Skipping file creation: ${n.error} - ${o}`),new p.Notice(`Skipped file "${t.name}": ${n.error}`);return}await this.app.vault.create(`${e.path}/${o}`,s)}else if(t instanceof p.TFolder){let a=this.processor.processVariables(t.name,e),s=await this.app.vault.createFolder(`${e.path}/${a}`);await this.copyFolderContents(t,s)}}async getTemplates(){let i=this.app.vault.getAbstractFileByPath(this.settings.templateFolder);if(!i||!(i instanceof p.TFolder))throw new Error(`Template folder "${this.settings.templateFolder}" not found`);let e=[];for(let t of i.children)(t instanceof p.TFile&&t.extension==="md"||t instanceof p.TFolder&&this.settings.enableFolderTemplates)&&e.push(t);return e}filterAndSortTemplates(i){let e=this.settings.templateConfigs;if(e.length===0)return i;let t=e.filter(s=>s.visible).sort((s,o)=>s.order-o.order),a=[];return t.forEach(s=>{let o=i.find(n=>n.path===s.path);o&&a.push(o)}),a}};var m=require("obsidian"),w=class extends m.PluginSettingTab{constructor(e,t,a,s,o){super(e,t);this.plugin=t;this.settings=a;this.saveSettings=s;this.onTemplateMenuStyleChange=o}display(){let{containerEl:e}=this;e.empty(),new m.Setting(e).setName("Templates folder location").setDesc("Files in this folder will be available as templates.").addText(c=>{c.setPlaceholder("Example: Templates/Weekly/...").setValue(this.settings.templateFolder).onChange(async d=>{this.settings.templateFolder=d||"Templates",await this.saveSettings()});let l=c.inputEl;l.addEventListener("click",()=>{this.showFolderSuggestions(l)})});let a=new m.Setting(e).setName("Internal variables and functions").descEl;a.empty(),a.appendText("Templater Dir provides multiple predefined variables/functions that you can use. Check the ");let s=a.createEl("a",{text:"documentation",href:"#",cls:"variables-doc-link"});s.style.cssText="color: var(--text-accent); text-decoration: underline;",a.appendText(" to get a list of all the available internal variables/functions."),s.addEventListener("click",c=>{c.preventDefault(),this.showVariablesDocumentation()}),new m.Setting(e).setName("Enable folder templates").setDesc("Allows creating complete folder structures from template folders. Folders in your templates location will be available as templates.").addToggle(c=>c.setValue(this.settings.enableFolderTemplates).onChange(async l=>{this.settings.enableFolderTemplates=l,await this.saveSettings()})),new m.Setting(e).setName("Template Variables").setDesc("Enable variable replacement in templates ({{date}}, {{dayName}}, {{+Number}}, etc.)").addToggle(c=>c.setValue(this.settings.dateVariables).onChange(async l=>{this.settings.dateVariables=l,await this.saveSettings()}));let n=new m.Setting(e).setName("Template Name Display").addDropdown(c=>c.addOption("template","Template name only").addOption("result","Result only").addOption("both","Both (Template \u2192 Result)").setValue(this.settings.templateDisplayMode).onChange(async l=>{this.settings.templateDisplayMode=l,await this.saveSettings()})).descEl;n.empty(),n.appendText("How template names are shown in context menus. Check ");let r=n.createEl("a",{text:"documentation",href:"#",cls:"display-examples-link"});r.style.cssText="color: var(--text-accent); text-decoration: underline;",n.appendText(" for examples."),r.addEventListener("click",c=>{c.preventDefault(),this.showDisplayExamples()}),new m.Setting(e).setName("Template Menu Style").setDesc("How templates appear in folder context menus.").addDropdown(c=>c.addOption("grouped","Grouped").addOption("individual","Individual").setValue(this.settings.templateMenuStyle).onChange(async l=>{this.settings.templateMenuStyle=l,await this.saveSettings(),await this.onTemplateMenuStyleChange(l),this.display()})),this.settings.templateMenuStyle==="individual"&&this.addTemplateVisibilityControls(e)}showFolderSuggestions(e){this.removeFolderSuggestions();let t=this.getAllFolders();if(t.length===0)return;let a=document.createElement("div");a.className="template-folder-suggestions",a.style.cssText=`
			position: absolute;
			top: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			box-shadow: 0 2px 8px rgba(0,0,0,0.15);
		`,t.forEach(n=>{let r=document.createElement("div");r.className="template-folder-option",r.textContent=n.path,r.style.cssText=`
				padding: 8px 12px;
				cursor: pointer;
				border-bottom: 1px solid var(--background-modifier-border-hover);
			`,r.addEventListener("mouseenter",()=>{r.style.background="var(--background-modifier-hover)"}),r.addEventListener("mouseleave",()=>{r.style.background=""}),r.addEventListener("click",()=>{e.value=n.path,e.dispatchEvent(new Event("input",{bubbles:!0})),this.removeFolderSuggestions()}),a.appendChild(r)});let s=e.parentElement;s&&(s.style.position="relative",s.appendChild(a));let o=n=>{!e.contains(n.target)&&!a.contains(n.target)&&(this.removeFolderSuggestions(),document.removeEventListener("click",o))};setTimeout(()=>{document.addEventListener("click",o)},0)}removeFolderSuggestions(){let e=document.querySelector(".template-folder-suggestions");e&&e.remove()}getAllFolders(){let e=[],t=s=>{e.push(s);for(let o of s.children)o instanceof m.TFolder&&t(o)},a=this.app.vault.getRoot();for(let s of a.children)s instanceof m.TFolder&&t(s);return e.sort((s,o)=>s.path.localeCompare(o.path))}async addTemplateVisibilityControls(e){let t=new m.Setting(e).setName("Template Visibility").setDesc("Control which templates appear in context menus and their order."),a=await this.getTemplatesFromFolder();if(a.length===0){new m.Setting(e).setDesc("No templates found in the selected folder.");return}this.syncTemplateConfigs(a);let s=e.createDiv("template-visibility-list");s.style.cssText=`
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			padding: 10px;
			margin-top: 10px;
			background: var(--background-secondary);
		`,this.settings.templateConfigs.sort((n,r)=>n.order-r.order).forEach((n,r)=>{this.addTemplateControlItem(s,n,r,a)})}async getTemplatesFromFolder(){try{let e=this.app.vault.getAbstractFileByPath(this.settings.templateFolder);if(!e||!(e instanceof m.TFolder))return[];let t=[];for(let a of e.children)(a instanceof m.TFile&&a.extension==="md"||a instanceof m.TFolder&&this.settings.enableFolderTemplates)&&t.push(a);return t}catch(e){return console.error("Error getting templates:",e),[]}}syncTemplateConfigs(e){let t=e.map(a=>a.path);this.settings.templateConfigs=this.settings.templateConfigs.filter(a=>t.includes(a.path)),e.forEach((a,s)=>{this.settings.templateConfigs.find(n=>n.path===a.path)||this.settings.templateConfigs.push({path:a.path,visible:!0,order:s})})}addTemplateControlItem(e,t,a,s){let o=s.find(C=>C.path===t.path);if(!o)return;let n=e.createDiv("template-control-item");n.style.cssText=`
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 8px 12px;
			border-radius: 4px;
			margin-bottom: 4px;
			background: var(--background-primary);
			${t.visible?"":"opacity: 0.5; color: var(--text-muted);"}
		`;let r=n.createDiv("template-info");r.style.cssText="display: flex; align-items: center; flex: 1;";let c=r.createSpan("template-name");c.textContent=o.name;let l=n.createDiv("template-controls");l.style.cssText="display: flex; align-items: center; gap: 8px;";let d=l.createEl("button",{text:"\u2191"});d.style.cssText="min-width: 24px; height: 24px;",d.disabled=a===0,d.onclick=()=>this.moveTemplate(t,-1);let g=l.createEl("button",{text:"\u2193"});g.style.cssText="min-width: 24px; height: 24px;",g.disabled=a===this.settings.templateConfigs.length-1,g.onclick=()=>this.moveTemplate(t,1);let f=l.createEl("button",{text:t.visible?"Hide":"Show"});f.style.cssText=`
			min-width: 50px; 
			height: 24px;
			background: ${t.visible?"var(--interactive-accent)":"var(--background-modifier-border)"};
			color: ${t.visible?"white":"var(--text-muted)"};
		`,f.onclick=()=>this.toggleTemplateVisibility(t)}async moveTemplate(e,t){let s=this.settings.templateConfigs.findIndex(r=>r.path===e.path)+t;if(s<0||s>=this.settings.templateConfigs.length)return;let o=this.settings.templateConfigs[s],n=e.order;e.order=o.order,o.order=n,await this.saveSettings(),this.display()}async toggleTemplateVisibility(e){e.visible=!e.visible,await this.saveSettings(),this.display()}showVariablesDocumentation(){new D(this.app).open()}showDisplayExamples(){new k(this.app).open()}},D=class extends m.Modal{constructor(i){super(i)}onOpen(){let{contentEl:i}=this;i.empty(),this.setTitle("Template Variables Documentation");let e=["{{date}} - Current date (2025-08-30)","{{dayName}} - Current day (Friday)","{{year}} - Current year (2025)","{{month}} - Current month (08)","{{day}} - Current day (30)","{{time}} - Current time (14:30)","{{hour}} - Current hour (14)","{{minute}} - Current minute (30)","{{weekDay1}} - Monday","{{weekDay2}} - Tuesday","{{weekDay3}} - Wednesday","{{weekDay4}} - Thursday","{{weekDay5}} - Friday","{{weekDay6}} - Saturday","{{weekDay7}} - Sunday","{{uuid}} - Random UUID (a1b2c3d4-...)","{{+Number}} - Auto-increment (01, 02, 03...)"],t=i.createDiv();t.style.cssText="font-family: monospace; font-size: 14px; line-height: 1.6;",e.forEach(a=>{let s=t.createDiv();s.style.cssText="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; padding: 4px 8px; background: var(--background-secondary); border-radius: 4px;";let o=s.createSpan();o.textContent=a;let n=s.createEl("button",{text:"copy"});n.style.cssText="min-width: 40px; height: 24px; font-size: 11px; background: transparent; color: var(--text-muted); border: 1px solid var(--background-modifier-border); border-radius: 3px; cursor: pointer;";let r=a.match(/(\{\{[^}]+\}\})/),c=r?r[1]:a;n.onclick=()=>{navigator.clipboard.writeText(c).then(()=>{n.textContent="\u2713",n.style.color="var(--text-success)",setTimeout(()=>{n.textContent="copy",n.style.color="var(--text-muted)"},1e3)}).catch(()=>{let l=document.createElement("textarea");l.value=c,document.body.appendChild(l),l.select(),document.execCommand("copy"),document.body.removeChild(l),n.textContent="\u2713",n.style.color="var(--text-success)",setTimeout(()=>{n.textContent="copy",n.style.color="var(--text-muted)"},1e3)})}})}onClose(){let{contentEl:i}=this;i.empty()}},k=class extends m.Modal{constructor(i){super(i)}onOpen(){let{contentEl:i}=this;i.empty(),this.setTitle("Template Name Display Examples"),[{mode:"Template name only",description:"Shows the raw template name with variables",items:["Week_{{+Number}}","Daily_{{date}}.md","{{dayName}}_Meeting"]},{mode:"Result only",description:"Shows only the processed result",items:["Week_01","Daily_2025-08-30.md","Friday_Meeting"]},{mode:"Both (Template \u2192 Result)",description:"Shows template name and result",items:["Week_{{+Number}} \u2192 Week_01","Daily_{{date}}.md \u2192 Daily_2025-08-30.md","{{dayName}}_Meeting \u2192 Friday_Meeting"]}].forEach((t,a)=>{let s=i.createEl("h3");s.textContent=t.mode,s.style.cssText="margin-top: 20px; margin-bottom: 8px; color: var(--text-accent);",a===0&&(s.style.marginTop="0");let o=i.createDiv();o.textContent=t.description,o.style.cssText="margin-bottom: 12px; color: var(--text-muted); font-style: italic;";let n=i.createDiv();n.style.cssText="font-family: monospace; font-size: 14px; line-height: 1.6; margin-bottom: 16px;",t.items.forEach(r=>{let c=n.createDiv();c.textContent=`\u2022 ${r}`,c.style.cssText="margin-bottom: 4px; padding: 4px 8px; background: var(--background-secondary); border-radius: 4px;"})})}onClose(){let{contentEl:i}=this;i.empty()}};var F=class extends u.Plugin{async onload(){await this.loadSettings(),this.templateManager=new b(this.app,this.settings),await this.templateManager.initializeCache(),this.addSettingTab(new w(this.app,this,this.settings,()=>this.saveSettings(),e=>this.onTemplateMenuStyleChange(e))),this.registerEvent(this.app.workspace.on("file-menu",(e,t)=>{t instanceof u.TFolder&&this.templateManager.addTemplateContextMenu(e,t)})),this.registerEvent(this.app.vault.on("create",e=>{this.onFileChange()})),this.registerEvent(this.app.vault.on("delete",e=>{this.onFileChange()})),this.registerEvent(this.app.vault.on("rename",(e,t)=>{this.onFileChange()})),this.setupCommands()}async loadSettings(){this.settings=Object.assign({},M,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async onTemplateMenuStyleChange(e){this.settings.templateMenuStyle=e,await this.saveSettings(),await this.templateManager.updateCache()}onFileChange(){this.settings.templateMenuStyle==="individual"&&(clearTimeout(this.cacheUpdateTimeout),this.cacheUpdateTimeout=window.setTimeout(async()=>{await this.templateManager.updateCache(),console.log("Template cache updated due to file changes")},500))}setupCommands(){this.addCommand({id:"refresh-template-cache",name:"Refresh template cache",callback:()=>{this.templateManager.updateCache(),new u.Notice("Template cache refreshed")}})}onunload(){this.cacheUpdateTimeout&&clearTimeout(this.cacheUpdateTimeout)}};
